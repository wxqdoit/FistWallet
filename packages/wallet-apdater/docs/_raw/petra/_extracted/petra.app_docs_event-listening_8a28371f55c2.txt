[LI] Petra WebIntroduction
[LI] Frequently Asked Questions
[LI] Developer's GuideQuick Start
[LI] Error Codes
[LI] Telegram
[LI] Sign In with Aptos
[LI] Petra VaultIntroduction
[LI] GuidesCreate a Vault
[LI] Transaction Management
[LI] Publish a Contract
[LI] Backup your Vaults
[LI] Earn
[LI] DevelopersAccounts Types
[LI] Connecting to Petra Wallet
[LI] Deep Linking to Mobile App
[LI] Event Listening
[LI] Identifying Errors
[LI] Sending a Transaction
[LI] Signing Messages
[LI] Using Petra
[LI] Frequently Asked Questions
[P] On This Page
[LI] onNetworkChange() and network()
[LI] onAccountChange()
[H1] Event Listening
[H2] onNetworkChange() and network()
[P] A dApp may want to make sure a user is on the right network. In this case, you will need to check what network the wallet is using.
[P] Default networks provided by the Petra wallet:
[CODE] // default networks in the wallet
enum Network {
  Testnet = 'Testnet',
  Mainnet = 'Mainnet',
  Devnet = 'Devnet',
}
 
// Current network
let network = await window.aptos.network();
 
// event listener for network changing
window.aptos.onNetworkChange((newNetwork) => {
  network = newNetwork;
});
[H2] onAccountChange()
[CODE] In Petra, a user may change accounts while interacting with your app. To check for these events, listen for them with: onAccountChange
[CODE] // get current account
let currentAccount = await window.aptos.account();
 
// event listener for disconnecting
window.aptos.onAccountChange((newAccount) => {
  // If the new account has already connected to your app then the newAccount will be returned
  if (newAccount) {
    currentAccount = newAccount;
  } else {
    // Otherwise you will need to ask to connect to the new account
    currentAccount = window.aptos.connect();
  }
});
[H1] onDisconnect()
[P] A user may choose to disconnect from your dApp. In that case, you will want to update your state.
[CODE] // get current connection status
let connectionStatus = await window.aptos.isConnected();
 
// event listener for disconnecting
window.aptos.onDisconnect(() => {
  connectionStatus = false;
});